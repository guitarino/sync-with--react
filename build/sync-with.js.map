{"version":3,"sources":["../src/sync-with.jsx"],"names":["findRefNode","ref","Node","mutationConfig","attributes","childList","characterData","subtree","Sync","syncRef","mutationObserver","disconnect","node","MutationObserver","handleRefUpdate","observe","forceUpdate","bind","syncWith","createRefCallbacks","checkRefs","result"],"mappings":";;;;;;;;AAMA;;AACA;;AACA;;;;;;;;;;+eARA;;;;;;AAUA,SAASA,WAAT,CAAqBC,GAArB,EAA0B;AACxB,SAAOA,eAAeC,IAAf,GAAsBD,GAAtB,GAA4B,2BAAYA,GAAZ,CAAnC;AACD;;AAED,IAAIE,iBAAiB;AACnBC,cAAY,IADO;AAEnBC,aAAW,IAFQ;AAGnBC,iBAAe,IAHI;AAInBC,WAAS;AAJU,CAArB;;IAOqBC,I;;;;;;;;;;;6BACV;AACP,aACE,KAAKC,OAAL,GAAe,2BAAYT,YAAY,KAAKS,OAAjB,CAAZ,CAAf,GAAwD,IAD1D;AAGD;;;6BAEQR,G,EAAK;AACZ,UAAI,KAAKS,gBAAT,EAA2B;AACzB,aAAKA,gBAAL,CAAsBC,UAAtB;AACD;AACD,UAAIV,GAAJ,EAAS;AACP,YAAIW,OAAOZ,YAAYC,GAAZ,CAAX;AACA,YAAIW,IAAJ,EAAU;AACR,eAAKF,gBAAL,GAAwB,IAAIG,gBAAJ,CAAqB,KAAKC,eAA1B,CAAxB;AACA,eAAKJ,gBAAL,CAAsBK,OAAtB,CACEH,IADF,EAEET,cAFF;AAID;AACF;AACD,WAAKM,OAAL,GAAeR,GAAf;AACA,WAAKa,eAAL;AACD;;;sCAEiB;AAChB,WAAKE,WAAL;AACD;;;yCAEoB;AACnB,WAAKF,eAAL,GAAuB,KAAKA,eAAL,CAAqBG,IAArB,CAA0B,IAA1B,CAAvB;AACD;;;2CAEsB;AACrB,WAAKC,QAAL,CAAc,IAAd;AACD;;;;;;kBAnCkBV,I;;;AAsCrBA,KAAKW,kBAAL,GAA0B,YAAW;AACnC,MACElB,IADF;AAAA,MAEEQ,QAFF;AAAA,MAGEW,YAAY,SAAZA,SAAY,GAAW;AACrB,QAAIX,QAAJ,EAAa;AACXA,eAAQS,QAAR,CAAiBjB,IAAjB;AACD;AACF,GAPH;AASA,SAAO;AACLA,SAAK,aAASoB,MAAT,EAAiB;AACpBpB,aAAMoB,MAAN;AACAD;AACD,KAJI;AAKLX,aAAS,iBAASY,MAAT,EAAiB;AACxBZ,iBAAUY,MAAV;AACAD;AACD;AARI,GAAP;AAUD,CApBD","file":"sync-with.js","sourcesContent":["/**\r\n * @license MIT\r\n * @copyright Kirill Shestakov 2017\r\n * @see https://github.com/guitarino/sync-with--react/\r\n */\r\n\r\nimport { Component } from 'react';\r\nimport { findDOMNode } from 'react-dom';\r\nimport createVNode from './createVNode';\r\n\r\nfunction findRefNode(ref) {\r\n  return ref instanceof Node ? ref : findDOMNode(ref);\r\n};\r\n\r\nvar mutationConfig = {\r\n  attributes: true,\r\n  childList: true,\r\n  characterData: true,\r\n  subtree: true\r\n};\r\n\r\nexport default class Sync extends Component {\r\n  render() {\r\n    return (\r\n      this.syncRef ? createVNode(findRefNode(this.syncRef)) : null\r\n    );\r\n  }\r\n\r\n  syncWith(ref) {\r\n    if (this.mutationObserver) {\r\n      this.mutationObserver.disconnect();\r\n    }\r\n    if (ref) {\r\n      let node = findRefNode(ref);\r\n      if (node) {\r\n        this.mutationObserver = new MutationObserver(this.handleRefUpdate);\r\n        this.mutationObserver.observe(\r\n          node,\r\n          mutationConfig\r\n        );\r\n      }\r\n    }\r\n    this.syncRef = ref;\r\n    this.handleRefUpdate();\r\n  }\r\n\r\n  handleRefUpdate() {\r\n    this.forceUpdate();\r\n  }\r\n\r\n  componentWillMount() {\r\n    this.handleRefUpdate = this.handleRefUpdate.bind(this);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.syncWith(null);\r\n  }\r\n}\r\n\r\nSync.createRefCallbacks = function() {\r\n  var\r\n    ref,\r\n    syncRef,\r\n    checkRefs = function() {\r\n      if (syncRef) {\r\n        syncRef.syncWith(ref)\r\n      }\r\n    }\r\n  ;\r\n  return {\r\n    ref: function(result) {\r\n      ref = result;\r\n      checkRefs();\r\n    },\r\n    syncRef: function(result) {\r\n      syncRef = result;\r\n      checkRefs();\r\n    }\r\n  }\r\n};"]}